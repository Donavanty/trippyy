(this.webpackJsonptrippyy=this.webpackJsonptrippyy||[]).push([[0],{131:function(e,t,a){},287:function(e,t,a){e.exports=a(619)},313:function(e,t,a){},315:function(e,t,a){},327:function(e,t){},619:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(31),l=a.n(o),i=a(8),c=a(9),s=a(10),u=a(12),p=a(11),m=a(37),h=a.n(m),d="https://trippyy-backend.herokuapp.com/",g=function(e,t,a){return{token:e,type:"AUTH_SUCCESS",username:t,userId:a}},f=function(e){return{error:e,type:"AUTH_FAIL"}},v=function(){return localStorage.clear(),{type:"AUTH_LOGOUT"}},E=function(e){return function(t){setTimeout((function(){t(v())}),1e3*e)}},y=function(e,t){return function(a){a({type:"AUTH_START"}),h.a.post(d+"api/authenticate/",{username:e,password:t}).then((function(t){var n=t.data.token,r=t.data.id,o=new Date((new Date).getTime()+36e5);localStorage.setItem("token",n),localStorage.setItem("expirationDate",o),localStorage.setItem("username",e),localStorage.setItem("userId",r),a(g(n,e,r)),a(E(3600))})).catch((function(e){a(f(e))}))}},b=function(){return function(e){var t=localStorage.getItem("token"),a=localStorage.getItem("username");if(void 0===t||null===t)e((localStorage.removeItem("username"),localStorage.removeItem("user"),localStorage.removeItem("expirationDate"),localStorage.removeItem("token"),localStorage.removeItem("userId"),{type:"AUTH_LOGOUT"}));else{var n=new Date(localStorage.getItem("expirationDate"));n<=new Date?e(v()):(e(g(t,a)),e(E((n.getTime()-(new Date).getTime())/1e3)))}}},S=function(e,t,a,n,r){return function(o){o({type:"AUTH_START"}),o(function(e,t,a,n,r){var o={destination:e,tripName:"Trip to "+e+" from "+n+" to "+r,startDate:n,endDate:r};h.a.post(d+"api/trips/",o,{headers:{Authorization:"Token "+localStorage.token}}).then((function(e){return console.log(e)}));var l={country:e,lat:t,lng:a,startDate:n,endDate:r};return localStorage.setItem("trip",JSON.stringify(l)),{type:"NEW_TRIP",trip:l}}(e,t,a,n,r))}},O=function(){return{type:"NEW_TRIP",trip:JSON.parse(localStorage.trip)}},k=a(14),j=(a(312),a(38)),D=(a(313),function(e){Object(u.a)(a,e);var t=Object(p.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(s.a)(a,[{key:"render",value:function(){return r.a.createElement("nav",{className:"navbar fixed-top navbar-expand-lg",id:"nav1"},r.a.createElement(j.b,{to:"/",className:"navbar-brand",href:"#"},"trippyy"),r.a.createElement("button",{className:"navbar-toggler",type:"button","data-toggle":"collapse","data-target":"#navbarNav","aria-controls":"navbarNav","aria-expanded":"false","aria-label":"Toggle navigation"},r.a.createElement("span",{className:"navbar-toggler-icon"})),r.a.createElement("div",{className:"collapse navbar-collapse col-11",id:"navbar-nav"},r.a.createElement("ul",{className:"navbar-nav justify-content-center"},r.a.createElement("li",{className:"nav-item"},r.a.createElement(j.b,{to:"/",className:"nav-link"}," Home ")),r.a.createElement("li",{className:"nav-item"},r.a.createElement(j.b,{to:"/mytrips",className:"nav-link"}," My Trips",r.a.createElement("span",{className:"sr-only"},"(current)"))),this.props.isAuthenticated?r.a.createElement(r.a.Fragment,null,r.a.createElement("li",{className:"nav-item"},r.a.createElement(j.b,{to:"/",className:"nav-link",onClick:this.props.logout},"Logout")),r.a.createElement("li",{className:"nav-item"},r.a.createElement(j.b,{to:"/mytrips",className:"nav-link"}," Account: ",this.props.username," "))):r.a.createElement(r.a.Fragment,null,r.a.createElement("li",{className:"nav-item"},r.a.createElement(j.b,{to:{pathname:"/login",state:{from:this.props.from}},className:"nav-link"}," Login ")),r.a.createElement("li",{className:"nav-item"},r.a.createElement(j.b,{to:"/signup",className:"nav-link"}," Signup "))))))}}]),a}(n.Component)),N=Object(k.b)((function(e){return{isAuthenticated:null!==e.token,username:e.username}}),(function(e){return{onTryAutoSignup:function(){return e(b())},logout:function(){return e(v())}}}))(D),T=(a(315),a(316),a(365),a(281)),A=function(e){Object(u.a)(a,e);var t=Object(p.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).state={startDate:null,endDate:null,focusedInput:null},n}return Object(s.a)(a,[{key:"render",value:function(){var e=this;return r.a.createElement(T.DateRangePicker,{startDateId:"startDate",endDateId:"endDate",startDate:this.state.startDate,endDate:this.state.endDate,onDatesChange:function(t){var a=t.startDate,n=t.endDate;e.setState({startDate:a,endDate:n}),null!==n&&null!==a&&e.props.updateDates(a.format("YYYY-MM-DD"),n.format("YYYY-MM-DD"))},focusedInput:this.state.focusedInput,onFocusChange:function(t){e.setState({focusedInput:t})}})}}]),a}(n.Component),I=a(620),w=a(115),C=a.n(w),U=function(e){Object(u.a)(a,e);var t=Object(p.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).handleChange=function(e){n.setState({address:e})},n.handleSelect=function(e){n.setState({address:e}),Object(w.geocodeByAddress)(e).then((function(e){return Object(w.getLatLng)(e[0])})).then((function(t){return n.props.updateCountry(e,t)})).catch((function(e){return console.log(e)}))},n.searchOptions={types:["(regions)"]},n.state={address:""},n}return Object(s.a)(a,[{key:"render",value:function(){return r.a.createElement(C.a,{value:this.state.address,onChange:this.handleChange,onSelect:this.handleSelect,searchOptions:this.searchOptions,highlightFirstSuggestion:!0},(function(e){var t=e.getInputProps,a=e.suggestions,n=e.getSuggestionItemProps,o=e.loading;return r.a.createElement("div",null,r.a.createElement("input",t({placeholder:"Search City",className:"location-search-input"})),r.a.createElement("div",{className:"autocomplete-dropdown-container"},o,a.map((function(e){var t=e.active?"suggestion-item--active":"suggestion-item",a=e.active?{backgroundColor:"#fafafa",cursor:"pointer"}:{backgroundColor:"#ffffff",cursor:"pointer"};return r.a.createElement("div",n(e,{className:t,style:a}),r.a.createElement("span",null,e.description))}))))}))}}]),a}(n.Component),L=function(e){Object(u.a)(a,e);var t=Object(p.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={newTripCreated:!1,goToShoppingPage:!1},e.updateDates=function(t,a){e.setState({startDate:t,endDate:a})},e.updateCountry=function(t,a){e.setState({countryName:t,latLng:a})},e.newTrip=function(t){null==e.state.startDate||null==e.state.endDate?alert("Please choose dates first!"):null==e.state.countryName||null==e.state.latLng?alert("Please select a country from the list!"):(t.preventDefault(),e.props.newTrip(e.state.countryName,e.state.latLng.lat,e.state.latLng.lng,e.state.startDate,e.state.endDate),e.setState({newTripCreated:!0}))},e}return Object(s.a)(a,[{key:"componentDidUpdate",value:function(e,t,a){!0===this.state.goToShoppingPage&&this.props.history.push("/shopping")}},{key:"render",value:function(){return r.a.createElement("div",{className:"container-fluid align-items-center inputForm"},this.props.isAuthenticated?r.a.createElement("h1",null,"Hello, ",this.props.username,"!"):r.a.createElement("h1",null,"Hello stranger:)"),r.a.createElement("div",{className:"jumbotron"},r.a.createElement("form",{onSubmit:this.newTrip},r.a.createElement("div",null,r.a.createElement("h3",null," Enter Country: "),r.a.createElement(U,{updateCountry:this.updateCountry,name:"country"})),r.a.createElement("div",{className:"inputForm"},r.a.createElement("h3",null," Enter dates: "),r.a.createElement(A,{updateDates:this.updateDates})),r.a.createElement("div",{className:"inputForm"},this.props.loading?r.a.createElement(I.a,{animation:"border",role:"status"},r.a.createElement("span",{className:"sr-only"},"Loading...")):r.a.createElement("button",null," Submit ")))))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return!1===e.loading&&!0===t.newTripCreated?{goToShoppingPage:!0}:null}}]),a}(n.Component),_=Object(k.b)((function(e){return{isAuthenticated:null!==e.token,username:e.username,loading:e.loading}}),(function(e){return{newTrip:function(t,a,n,r,o){return e(S(t,a,n,r,o))}}}))(L),x=(a(131),function(e){Object(u.a)(a,e);var t=Object(p.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(s.a)(a,[{key:"componentDidMount",value:function(){this.props.onTryAutoSignup()}},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(N,{from:this.props.location.pathname}),r.a.createElement(_,{history:this.props.history}))}}]),a}(n.Component)),M=Object(k.b)((function(e){return{isAuthenticated:null!==e.token}}),(function(e){return{onTryAutoSignup:function(){return e(b())}}}))(x),P=function(e){Object(u.a)(a,e);var t=Object(p.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).handleSubmit=function(t){t.preventDefault(),e.props.onAuth(t.target.username.value,t.target.password.value)},e}return Object(s.a)(a,[{key:"componentDidMount",value:function(){this.props.onTryAutoSignup(),null!==localStorage.token&&void 0!==localStorage.token&&this.props.history.push("/")}},{key:"componentDidUpdate",value:function(e,t,a){if(this.props.isAuthenticated)if(void 0===this.props.location.state||null===this.props.location.state)this.props.history.push("/");else{var n=this.props.location.state.from;this.props.history.push(n),this.setState({from:null})}}},{key:"render",value:function(){return r.a.createElement("div",{className:"container-fluid align-items-center"},r.a.createElement(N,{from:this.props.location.pathname}),r.a.createElement("div",{className:"jumbotron startBox"},r.a.createElement("h1",null," Login"),r.a.createElement("form",{onSubmit:this.handleSubmit},r.a.createElement("div",{className:"element"},r.a.createElement("input",{type:"text",name:"username",placeholder:"Enter Username"})),r.a.createElement("div",{className:"element"},r.a.createElement("input",{type:"text",name:"password",placeholder:"Enter Password"})),this.props.loading?r.a.createElement(I.a,{animation:"border",role:"status",className:"element"},r.a.createElement("span",{className:"sr-only"},"Loading...")):r.a.createElement("button",{className:"element",type:"submit",value:"Submit"}," Submit "))))}}]),a}(n.Component),H=Object(k.b)((function(e){return{isAuthenticated:null!==e.token,loading:e.loading,error:e.error}}),(function(e){return{onTryAutoSignup:function(){return e(b())},onAuth:function(t,a){return e(y(t,a))}}}))(P),F=function(e){Object(u.a)(a,e);var t=Object(p.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).handleSubmit=function(t){t.preventDefault(),e.props.onAuth(t.target.username.value,t.target.email.value,t.target.password1.value,t.target.password2.value),e.props.history.push("/")},e}return Object(s.a)(a,[{key:"componentDidMount",value:function(){this.props.onTryAutoSignup(),null!==localStorage.token&&void 0!==localStorage.token&&(alert("Please logout to create a new account"),this.props.history.push("/"))}},{key:"render",value:function(){return r.a.createElement("div",{className:"container-fluid align-items-center"},r.a.createElement(N,{from:this.props.location.pathname}),r.a.createElement("div",{className:"jumbotron startBox"},r.a.createElement("h1",null," SIGN UP"),r.a.createElement("form",{onSubmit:this.handleSubmit},r.a.createElement("div",{className:"element"},r.a.createElement("input",{type:"text",name:"username",placeholder:"Enter Username"})),r.a.createElement("div",{className:"element"},r.a.createElement("input",{type:"text",name:"email",placeholder:"Enter Email"})),r.a.createElement("div",{className:"element"},r.a.createElement("input",{type:"text",name:"password1",placeholder:"Enter Password"})),r.a.createElement("div",{className:"element"},r.a.createElement("input",{type:"text",name:"password2",placeholder:"Enter Password again"})),r.a.createElement("button",{className:"element",type:"submit",value:"Submit"}," Signup "))))}}]),a}(n.Component),R=Object(k.b)((function(e){return{}}),(function(e){return{onAuth:function(t,a,n,r){return e(function(e,t,a,n){return function(r){r({type:"AUTH_START"}),h.a.post(d+"rest-auth/registration/",{username:e,email:t,password1:a,password2:n}).then((function(t){r(y(e,a))})).catch((function(e){r(f(e))}))}}(t,a,n,r))},onTryAutoSignup:function(){return e(b())}}}))(F),Y=a(286),J=function(e){Object(u.a)(a,e);var t=Object(p.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={tripIDs:[],trips:[],local_loading:null},e}return Object(s.a)(a,[{key:"componentDidMount",value:function(){var e=this;this.setState({local_loading:!0}),this.props.onTryAutoSignup(),null!=localStorage.getItem("token")&&void 0!=localStorage.getItem("token")||this.props.history.push({pathname:"/login",state:{from:this.props.location.pathname}});try{h.a.get("https://trippyy-backend.herokuapp.com/api/users/"+localStorage.userId,{headers:{Authorization:"Token "+localStorage.token}}).then((function(t){e.setState({tripIDs:t.data.trips})})).then((function(t){for(var a=function(t){h.a.get("https://trippyy-backend.herokuapp.com/api/trips/"+e.state.tripIDs[t],{headers:{Authorization:"Token "+localStorage.token}}).then((function(a){e.setState({trips:[].concat(Object(Y.a)(e.state.trips),[a.data])}),t===e.state.tripIDs.length-1&&e.setState({local_loading:!1})}))},n=0;n<e.state.tripIDs.length;n++)a(n)}))}catch(t){alert(t),this.props.history.push("/")}}},{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(N,{from:this.props.location.pathname}),r.a.createElement("div",{className:"jumbotron startBox"},r.a.createElement("h1",null," My Trips "),this.state.local_loading?r.a.createElement(I.a,{animation:"border",role:"status"},r.a.createElement("span",{className:"sr-only"},"Loading...")):this.state.trips.length>0?r.a.createElement("ul",null,this.state.trips.map((function(e,t){return r.a.createElement("li",{key:t}," ",e.tripName," ")}))):r.a.createElement("p",null," No trips available ")))}}]),a}(n.Component),B=Object(k.b)((function(e){return{isAuthenticated:null!==e.token,username:e.username}}),(function(e){return{onTryAutoSignup:function(){return e(b())}}}))(J),G=a(89),W=function(e){Object(u.a)(a,e);var t=Object(p.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,o=new Array(n),l=0;l<n;l++)o[l]=arguments[l];return(e=t.call.apply(t,[this].concat(o))).state={trip:null,startLat:null,startLng:null},e.WrappedMap=Object(G.withScriptjs)(Object(G.withGoogleMap)((function(t){return r.a.createElement(G.GoogleMap,{defaultZoom:12,defaultCenter:{lat:e.state.startLat,lng:e.state.startLng}},t.children)}))),e}return Object(s.a)(a,[{key:"componentDidMount",value:function(){this.props.checkedTrip(),this.setState({startLng:JSON.parse(localStorage.trip).lng,startLat:JSON.parse(localStorage.trip).lat})}},{key:"componentDidUpdate",value:function(e,t,a){}},{key:"render",value:function(){return r.a.createElement(n.Fragment,null,r.a.createElement(this.WrappedMap,{googleMapURL:this.props.googleMapURL,loadingElement:r.a.createElement("div",{style:{height:"100%"}}),containerElement:r.a.createElement("div",{style:{height:"600px"}}),mapElement:r.a.createElement("div",{style:{height:"100%"}}),center:{lat:40.73061,lng:-73.935242}},r.a.createElement(G.Marker,{position:{lat:-34.397,lng:150.644}})))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return null!==e.trip?{trip:e.trip}:null}}]),a}(n.Component);W.defaultProps={googleMapURL:"https://maps.googleapis.com/maps/api/js?key=AIzaSyB-tj53yeTQiKnUmi_Jr2a7caz5RJVY60Y&v=3.exp&libraries=geometry,drawing,places"};var z=Object(k.b)((function(e){return{trip:e.trip}}),(function(e){return{checkedTrip:function(){return e(O())}}}))(W),V=function(e){Object(u.a)(a,e);var t=Object(p.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(s.a)(a,[{key:"componentDidMount",value:function(){this.props.onTryAutoSignup(),this.props.checkedTrip(),null!==localStorage.trip&&void 0!==localStorage.trip||this.props.history.push("/")}},{key:"componentDidUpdate",value:function(e,t,a){}},{key:"render",value:function(){return r.a.createElement("div",{className:"container-fluid align-items-center"},r.a.createElement(N,{from:this.props.location.pathname}),r.a.createElement("div",{className:"jumbotron startBox"},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-4"},r.a.createElement("h1",null," Shopping! "),r.a.createElement("p",null," Welcome to ",this.props.trip.country," ")),r.a.createElement("div",{className:"col-8"},r.a.createElement(z,null)))))}}]),a}(n.Component),X=Object(k.b)((function(e){return{isAuthenticated:null!==e.token,trip:e.trip,loading:e.loading,error:e.error}}),(function(e){return{onTryAutoSignup:function(){return e(b())},onAuth:function(t,a){return e(y(t,a))},checkedTrip:function(){return e(O())}}}))(V),K=function(){return r.a.createElement(i.c,null,r.a.createElement(i.a,{exact:!0,path:"/",component:M}),r.a.createElement(i.a,{exact:!0,path:"/login/",component:H}),r.a.createElement(i.a,{exact:!0,path:"/signup/",component:R}),r.a.createElement(i.a,{exact:!0,path:"/mytrips",component:B}),r.a.createElement(i.a,{exact:!0,path:"/shopping",component:X}))},Q=a(158),Z=function(e,t){return Object(Q.a)(Object(Q.a)({},e),t)},q={token:null,error:null,loading:!1,username:null,userId:null,trip:{country:null,lat:null,lng:null,startDate:null,endDate:null}},$=function(e,t){return Z(e,{error:null,loading:!0})},ee=function(e,t){return Z(e,{token:t.token,error:null,loading:!1,username:t.username,userId:t.userId})},te=function(e,t){return Z(e,{error:t.error,loading:!1})},ae=function(e,t){return Z(e,{token:null})},ne=function(e,t){return Z(e,{trip:t.trip,loading:!1})},re=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:q,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"NEW_TRIP":return ne(e,t);case"AUTH_START":return $(e);case"AUTH_SUCCESS":return ee(e,t);case"AUTH_FAIL":return te(e,t);case"AUTH_LOGOUT":return ae(e);default:return e}},oe=a(74),le=a(285),ie=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||oe.c,ce=Object(oe.d)(re,ie(Object(oe.a)(le.a))),se=r.a.createElement(k.a,{store:ce},r.a.createElement(j.a,null,r.a.createElement(K,null)));l.a.render(se,document.getElementById("root"))}},[[287,1,2]]]);
//# sourceMappingURL=main.8567a053.chunk.js.map